{"version":3,"sources":["HTTP.js"],"names":["URL","cc","VERSION","HTTP","Class","extends","Component","statics","sessionId","userId","master_url","url","sendRequest","path","data","handler","extraUrl","xhr","loader","getXMLHttpRequest","timeout","str","k","requestURL","encodeURI","console","log","open","sys","isNative","setRequestHeader","onreadystatechange","readyState","status","responseText","length","ret","JSON","parse","e","send"],"mappings":";;;;;;AAAA,IAAMA,MAAM,4BAAZ;AACAC,GAAGC,OAAH,GAAa,QAAb;AACA,IAAIC,OAAOF,GAAGG,KAAH,CAAS;AAChBC,aAASJ,GAAGK,SADI;;AAGhBC,aAAS;AACLC,mBAAW,CADN;AAELC,gBAAQ,CAFH;AAGLC,oBAAYV,GAHP;AAILW,aAAKX,GAJA;AAKLY,qBAAa,qBAAUC,IAAV,EAAgBC,IAAhB,EAAsBC,OAAtB,EAA+BC,QAA/B,EAAyC;AAClD,gBAAIC,MAAMhB,GAAGiB,MAAH,CAAUC,iBAAV,EAAV;AACAF,gBAAIG,OAAJ,GAAc,IAAd;AACA,gBAAIC,MAAM,GAAV;AACA,iBAAK,IAAIC,CAAT,IAAcR,IAAd,EAAoB;AAChB,oBAAIO,OAAO,GAAX,EAAgB;AACZA,2BAAO,GAAP;AACH;AACDA,uBAAOC,IAAI,GAAJ,GAAUR,KAAKQ,CAAL,CAAjB;AACH;AACD,gBAAIN,YAAY,IAAhB,EAAsB;AAClBA,2BAAWb,KAAKQ,GAAhB;AACH;AACD,gBAAIY,aAAaP,WAAWH,IAAX,GAAkBW,UAAUH,GAAV,CAAnC;AACAI,oBAAQC,GAAR,CAAY,oBAAoBH,UAAhC;AACAN,gBAAIU,IAAJ,CAAS,KAAT,EAAgBJ,UAAhB,EAA4B,IAA5B;AACA,gBAAItB,GAAG2B,GAAH,CAAOC,QAAX,EAAqB;AACjBZ,oBAAIa,gBAAJ,CAAqB,iBAArB,EAAwC,cAAxC,EAAwD,yBAAxD;AACH;;AAEDb,gBAAIc,kBAAJ,GAAyB,YAAY;AACjC,oBAAId,IAAIe,UAAJ,KAAmB,CAAnB,IAAyBf,IAAIgB,MAAJ,IAAc,GAAd,IAAqBhB,IAAIgB,MAAJ,GAAa,GAA/D,EAAqE;AACjER,4BAAQC,GAAR,CAAY,cAAcT,IAAIiB,YAAJ,CAAiBC,MAA/B,GAAwC,IAAxC,GAA+ClB,IAAIiB,YAA/D;AACA,wBAAI;AACA,4BAAIE,MAAMC,KAAKC,KAAL,CAAWrB,IAAIiB,YAAf,CAAV;AACA,4BAAInB,YAAY,IAAhB,EAAsB;AAClBA,oCAAQqB,GAAR;AACH,yBAJD,CAIyB;AAC5B,qBALD,CAKE,OAAOG,CAAP,EAAU;AACRd,gCAAQC,GAAR,CAAY,SAASa,CAArB;AACA;AACH,qBARD,SASQ,CACP;AACJ;AACJ,aAfD;;AAiBAtB,gBAAIuB,IAAJ;AACA,mBAAOvB,GAAP;AACH;AA5CI;AAHO,CAAT,CAAX","file":"HTTP.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\sprite\\Net","sourcesContent":["const URL = \"http://101.200.36.236:9000\";\r\ncc.VERSION = 20161227;\r\nvar HTTP = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    statics: {\r\n        sessionId: 0,\r\n        userId: 0,\r\n        master_url: URL,\r\n        url: URL,\r\n        sendRequest: function (path, data, handler, extraUrl) {\r\n            var xhr = cc.loader.getXMLHttpRequest();\r\n            xhr.timeout = 5000;\r\n            var str = \"?\";\r\n            for (var k in data) {\r\n                if (str != \"?\") {\r\n                    str += \"&\";\r\n                }\r\n                str += k + \"=\" + data[k];\r\n            }\r\n            if (extraUrl == null) {\r\n                extraUrl = HTTP.url;\r\n            }\r\n            var requestURL = extraUrl + path + encodeURI(str);\r\n            console.log(\"RequestURL....:\" + requestURL);\r\n            xhr.open(\"GET\", requestURL, true);\r\n            if (cc.sys.isNative) {\r\n                xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\", \"text/html;charset=UTF-8\");\r\n            }\r\n\r\n            xhr.onreadystatechange = function () {\r\n                if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n                    console.log(\"http res(\" + xhr.responseText.length + \"):\" + xhr.responseText);\r\n                    try {\r\n                        var ret = JSON.parse(xhr.responseText);\r\n                        if (handler !== null) {\r\n                            handler(ret);\r\n                        }                        /* code */\r\n                    } catch (e) {\r\n                        console.log(\"err:\" + e);\r\n                        //handler(null);\r\n                    }\r\n                    finally {\r\n                    }\r\n                }\r\n            };\r\n\r\n            xhr.send();\r\n            return xhr;\r\n        },\r\n    },\r\n});"]}