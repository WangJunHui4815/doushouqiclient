{"version":3,"sources":["../../../../../assets/sprite/controller/assets/sprite/controller/loginCtrl.js"],"names":["cc","vv","global","require","http","net","configs","emjioAtlas","UserMgr","GameNetMgr","Class","extends","Component","properties","onLoad","userMgr","gameNetMgr","initHandlers","start","checkVersion","self","onGetVersion","ret","version","console","log","hall","SI","xhr","complete","fnRequest","sendRequest","setTimeout","fn","abort","onBtnQuickStartClicked","guestAuth"],"mappings":";;;;;;AAAAA,GAAGC,EAAH,GAAQ,EAAR;AACAD,GAAGC,EAAH,CAAMC,MAAN,GAAeC,QAAQ,QAAR,CAAf;AACAH,GAAGC,EAAH,CAAMG,IAAN,GAAaD,QAAQ,MAAR,CAAb;AACAH,GAAGC,EAAH,CAAMI,GAAN,GAAYF,QAAQ,KAAR,CAAZ;AACAH,GAAGC,EAAH,CAAMK,OAAN,GAAgBH,QAAQ,SAAR,CAAhB;AACAH,GAAGC,EAAH,CAAMM,UAAN,GAAmB,IAAnB;AACA,IAAMC,UAAUL,QAAQ,SAAR,CAAhB;AACA,IAAMM,aAAaN,QAAQ,YAAR,CAAnB;;AAGAH,GAAGU,KAAH,CAAS;AACLC,aAASX,GAAGY,SADP;;AAGLC,gBAAY,EAHP;;AAML;;AAEAC,UARK,oBAQI;AACLd,WAAGC,EAAH,CAAMc,OAAN,GAAgB,IAAIP,OAAJ,EAAhB;AACAR,WAAGC,EAAH,CAAMe,UAAN,GAAmB,IAAIP,UAAJ,EAAnB;AACAT,WAAGC,EAAH,CAAMe,UAAN,CAAiBC,YAAjB;AACH,KAZI;AAcLC,SAdK,mBAcG;AACJ,aAAKC,YAAL;AACH,KAhBI;;;AAmBLA,kBAAc,wBAAY;AACtB,YAAIC,OAAO,IAAX;AACA,YAAIC,eAAe,SAAfA,YAAe,CAAUC,GAAV,EAAe;AAC9B,gBAAIA,IAAIC,OAAJ,IAAe,IAAnB,EAAyB;AACrBC,wBAAQC,GAAR,CAAY,QAAZ;AACH,aAFD,MAGK;AACDD,wBAAQC,GAAR,CAAY,kBAAZ;AACAD,wBAAQC,GAAR,CAAYH,IAAII,IAAhB;AACA1B,mBAAGC,EAAH,CAAM0B,EAAN,GAAWL,GAAX;AACH;AACJ,SATD;;AAWA,YAAIM,MAAM,IAAV;AACA,YAAIC,WAAW,KAAf;AACA,YAAIC,YAAY,SAAZA,SAAY,GAAY;AACxBF,kBAAM5B,GAAGC,EAAH,CAAMG,IAAN,CAAW2B,WAAX,CAAuB,iBAAvB,EAA0C,IAA1C,EAAgD,UAAUT,GAAV,EAAe;AACjEM,sBAAM,IAAN;AACAC,2BAAW,IAAX;AACAR,6BAAaC,GAAb;AACH,aAJK,CAAN;AAKAU,uBAAWC,EAAX,EAAe,IAAf;AACH,SAPD;;AASA,YAAIA,KAAK,SAALA,EAAK,GAAY;AACjB,gBAAI,CAACJ,QAAL,EAAe;AACX,oBAAID,GAAJ,EAAS;AACLA,wBAAIM,KAAJ;AACAF,+BAAW,YAAY;AACnBF;AACH,qBAFD,EAEG,IAFH;AAGH,iBALD,MAMK;AACDA;AACH;AACJ;AACJ,SAZD;AAaAG;AACH,KAzDI;;AA2DLE,4BAAwB,kCACxB;AACInC,WAAGC,EAAH,CAAMc,OAAN,CAAcqB,SAAd;AACH;;AAED;AAhEK,CAAT","file":"loginCtrl.js","sourceRoot":"../../../../../assets/sprite/controller","sourcesContent":["cc.vv = {}\ncc.vv.global = require(\"Global\");\ncc.vv.http = require(\"HTTP\");\ncc.vv.net = require(\"Net\");\ncc.vv.configs = require(\"Configs\");\ncc.vv.emjioAtlas = null\nconst UserMgr = require(\"UserMgr\");\nconst GameNetMgr = require(\"GameNetMgr\");\n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        cc.vv.userMgr = new UserMgr();\n        cc.vv.gameNetMgr = new GameNetMgr();\n        cc.vv.gameNetMgr.initHandlers();\n    },\n\n    start() {\n        this.checkVersion();\n    },\n\n\n    checkVersion: function () {\n        var self = this;\n        var onGetVersion = function (ret) {\n            if (ret.version == null) {\n                console.log(\"error.\");\n            }\n            else {\n                console.log(\"checkVersion ret\")\n                console.log(ret.hall)\n                cc.vv.SI = ret;\n            }\n        };\n\n        var xhr = null;\n        var complete = false;\n        var fnRequest = function () {\n            xhr = cc.vv.http.sendRequest(\"/get_serverinfo\", null, function (ret) {\n                xhr = null;\n                complete = true;\n                onGetVersion(ret);\n            });\n            setTimeout(fn, 5000);\n        }\n\n        var fn = function () {\n            if (!complete) {\n                if (xhr) {\n                    xhr.abort();\n                    setTimeout(function () {\n                        fnRequest();\n                    }, 5000);\n                }\n                else {\n                    fnRequest();\n                }\n            }\n        };\n        fn();\n    },\n\n    onBtnQuickStartClicked: function () \n    {\n        cc.vv.userMgr.guestAuth();\n    },\n\n    // update (dt) {},\n});\n"]}