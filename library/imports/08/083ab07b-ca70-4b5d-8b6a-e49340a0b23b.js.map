{"version":3,"sources":["../../../../../assets/sprite/common/assets/sprite/common/Tools.js"],"names":["module","exports","loadResDir","dirPath","callback","onResourceLoaded","errorMessage","spriteFrames","urlList","ret","cc","log","index","length","element","nameList","split","loader","SpriteFrame","createAnimationByName","emoji","animName","speed","repeatCount","animation","getComponent","Animation","addComponent","on","frameCount","frames","frameName","spriteFrame","vv","emjioAtlas","getSpriteFrame","clip","AnimationClip","createWithSpriteFrames","name","addClip","anim","play","Infinity"],"mappings":";;;;;;AAAAA,OAAOC,OAAP,GAAiB;AACbC,gBAAY,oBAAUC,OAAV,EAAmBC,QAAnB,EAA6B;AACrC,YAAIC,mBAAmB,SAAnBA,gBAAmB,CAAUC,YAAV,EAAwBC,YAAxB,EAAsCC,OAAtC,EAA+C;AAClE,gBAAIC,MAAM,EAAV;AACA;AACA,gBAAIH,YAAJ,EAAkB;AACdI,mBAAGC,GAAH,CAAO,+BAA+BL,YAAtC;AACA;AACH;AACD,iBAAK,IAAIM,QAAQ,CAAjB,EAAoBA,QAAQJ,QAAQK,MAApC,EAA4CD,OAA5C,EAAqD;AACjD,oBAAME,UAAUN,QAAQI,KAAR,CAAhB;AACA,oBAAIG,WAAWD,QAAQE,KAAR,CAAc,GAAd,CAAf;AACAP,oBAAIM,SAASA,SAASF,MAAT,GAAkB,CAA3B,CAAJ,IAAqCN,aAAaK,KAAb,CAArC;AACH;AACD,gBAAIR,YAAY,OAAQA,QAAR,IAAqB,UAArC,EAAiD;AAC7CA,yBAASK,GAAT;AACH;AACJ,SAfD;AAgBA;AACAC,WAAGO,MAAH,CAAUf,UAAV,CAAqBC,OAArB,EAA8BO,GAAGQ,WAAjC,EAA8Cb,gBAA9C;AACH,KApBY;;AAsBbc,yBAtBa,iCAsBSC,KAtBT,EAsBgBC,QAtBhB,EAsB0BC,KAtB1B,EAsBiCC,WAtBjC,EAsB8CnB,QAtB9C,EAsBwD;AACjE,YAAIoB,YAAYJ,MAAMK,YAAN,CAAmBf,GAAGgB,SAAtB,IAAmCN,MAAMK,YAAN,CAAmBf,GAAGgB,SAAtB,CAAnC,GAAsEN,MAAMO,YAAN,CAAmBjB,GAAGgB,SAAtB,CAAtF;AACA;AACAF,kBAAUI,EAAV,CAAa,UAAb,EAAyB,YAAY;AACjC,gBAAIxB,QAAJ,EAAc;AACVA;AACH;AACJ,SAJD,EAIG,IAJH;AAKA,YAAIyB,aAAa,CAAjB;AACA,YAAIC,SAAS,EAAb;AACA,aAAK,IAAIlB,QAAQ,CAAjB,EAAoBA,QAAQ,EAA5B,EAAgCA,OAAhC,EAAyC;AACrC,gBAAImB,YAAYV,WAAYT,KAA5B;AACA,gBAAIoB,cAActB,GAAGuB,EAAH,CAAMC,UAAN,CAAiBC,cAAjB,CAAgCJ,SAAhC,CAAlB;AACA,gBAAIC,WAAJ,EAAiB;AACbH;AACAC,uBAAOlB,KAAP,IAAgBoB,WAAhB;AACH,aAHD,MAIK;AACD;AACH;AACJ;;AAED,YAAII,OAAO1B,GAAG2B,aAAH,CAAiBC,sBAAjB,CAAwCR,MAAxC,EAAgDD,UAAhD,CAAX;AACAO,aAAKG,IAAL,GAAY,MAAZ;AACAf,kBAAUgB,OAAV,CAAkBJ,IAAlB;AACA,YAAIK,OAAOjB,UAAUkB,IAAV,CAAe,MAAf,CAAX;AACAD,aAAKnB,KAAL,GAAaA,SAAS,CAAtB;AACA,YAAIC,eAAe,EAAnB,EAAuB;AACnBkB,iBAAKlB,WAAL,GAAmBoB,QAAnB;AACH,SAFD,MAGK;AACDF,iBAAKlB,WAAL,GAAmBA,WAAnB;AACH;AACJ;AAvDY,CAAjB","file":"Tools.js","sourceRoot":"../../../../../assets/sprite/common","sourcesContent":["module.exports = {\n    loadResDir: function (dirPath, callback) {\n        let onResourceLoaded = function (errorMessage, spriteFrames, urlList) {\n            let ret = {};\n            // 检查失败原因\n            if (errorMessage) {\n                cc.log('Tools.loadResDir：加载失败, 原因:' + errorMessage);\n                return;\n            }\n            for (let index = 0; index < urlList.length; index++) {\n                const element = urlList[index];\n                var nameList = element.split(\"/\");\n                ret[nameList[nameList.length - 1]] = spriteFrames[index];\n            }\n            if (callback && typeof (callback) == \"function\") {\n                callback(ret);\n            }\n        };\n        // 這邊才是真的使用cc.loader進行載入，並且呼叫我們上面寫的方法\n        cc.loader.loadResDir(dirPath, cc.SpriteFrame, onResourceLoaded);\n    },\n\n    createAnimationByName(emoji, animName, speed, repeatCount, callback) {\n        let animation = emoji.getComponent(cc.Animation) ? emoji.getComponent(cc.Animation) : emoji.addComponent(cc.Animation)\n        // 注册动画结束时回掉\n        animation.on('finished', function () {\n            if (callback) {\n                callback();\n            }\n        }, this);\n        let frameCount = 0\n        let frames = [];\n        for (let index = 0; index < 99; index++) {\n            let frameName = animName + (index);\n            let spriteFrame = cc.vv.emjioAtlas.getSpriteFrame(frameName)\n            if (spriteFrame) {\n                frameCount++\n                frames[index] = spriteFrame\n            }\n            else {\n                break;\n            }\n        }\n\n        let clip = cc.AnimationClip.createWithSpriteFrames(frames, frameCount)\n        clip.name = \"clip\"\n        animation.addClip(clip)\n        let anim = animation.play(\"clip\")\n        anim.speed = speed || 6\n        if (repeatCount == 99) {\n            anim.repeatCount = Infinity;\n        }\n        else {\n            anim.repeatCount = repeatCount;\n        }\n    },\n}\n"]}